<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pendataan Warga Primrose RW 007</title>
    <style>
        /* Gaya dasar */
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background: url('Background_Primrose_app.jpg') no-repeat center center/cover;
            padding: 20px;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }

        .container {
            max-width: 500px;
            width: 100%;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            box-shadow: 0px 0px 15px rgba(0, 0, 0, 0.3);
            text-align: left;
            color: black;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            transition: opacity 0.3s ease;
            margin-bottom: 80px; /* Ruang untuk tombol di bagian bawah */
        }

        /* Logo Organisasi */
        .logo {
            width: 150px;
            margin-bottom: 5px; /* Jarak antara logo dan judul dikurangi 50% */
        }

        h2 {
            text-align: center;
            color: #333;
            margin-bottom: 10px; /* Jarak antara judul dan field dikurangi */
        }

        h3 {
            text-align: center;
            color: #333;
            margin-top: 10px; /* Jarak antara subjudul dan field dikurangi */
        }

        label {
            width: 100%;
            margin: 10px 0 5px 0;
            font-weight: bold;
        }

        input, select {
            width: 100%;
            padding: 10px;
            margin: 5px 0 10px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }

        button {
            padding: 12px;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
            font-size: 16px;
            transition: background 0.3s;
        }

        button:hover {
            opacity: 0.9;
        }

        .error {
            color: red;
            font-size: 14px;
            margin: 5px 0;
            display: none;
        }

        .info {
            font-size: 12px;
            color: #555;
            margin-top: 5px;
        }

        .page {
            display: none;
            width: 100%;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .page.active {
            display: block;
            opacity: 1;
        }

        /* Container untuk Tombol */
        .button-container {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            justify-content: center;
            width: 100%;
            max-width: 500px;
            padding: 0 20px;
            box-sizing: border-box;
        }

        /* Tombol Kembali */
        .back-button {
            background: rgba(0, 0, 0, 0.8); /* Hitam dengan transparansi 80% */
        }

        .back-button:hover {
            background: rgba(0, 0, 0, 0.9); /* Hitam lebih gelap saat hover */
        }

        /* Tombol Selanjutnya */
        .next-button {
            background: rgba(128, 0, 128, 0.8); /* Ungu dengan transparansi 80% */
        }

        .next-button:hover {
            background: rgba(128, 0, 128, 0.9); /* Ungu lebih gelap saat hover */
        }

        /* Tombol Submit */
        .submit-button {
            background: rgba(75, 0, 130, 0.8); /* Ungu tua dengan transparansi 80% */
        }

        .submit-button:hover {
            background: rgba(75, 0, 130, 0.9); /* Ungu tua lebih gelap saat hover */
        }

        .family-member {
            margin-top: 20px;
            border-top: 1px solid #ddd;
            padding-top: 20px;
        }

        /* Media Queries untuk Responsivitas */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            h2 {
                font-size: 24px;
            }

            input, select, button {
                font-size: 14px;
                padding: 8px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }

            h2 {
                font-size: 20px;
            }

            input, select, button {
                font-size: 12px;
                padding: 6px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Logo Organisasi -->
        <img src="primroselogo.jpg" alt="Logo Primrose" class="logo">

        <!-- Halaman 1 -->
        <div class="page active" id="page1">
            <h2>Pendataan Warga Primrose</h2>
            <h3>Data Alamat</h3>

            <!-- Field Blok Rumah -->
            <label for="block">Blok Rumah di Primrose:</label>
            <select id="block">
                <option value="">Pilih Blok</option>
                <option value="A">A</option>
                <option value="B">B</option>
                <option value="C">C</option>
                <option value="D">D</option>
                <option value="E">E</option>
                <option value="F">F</option>
                <option value="G">G</option>
                <option value="H">H</option>
                <option value="I">I</option>
                <option value="O">O</option>
                <option value="P">P</option>
                <option value="Q">Q</option>
                <option value="R">R</option>
                <option value="S">S</option>
                <option value="T">T</option>
                <option value="U">U</option>
                <option value="V">V</option>
            </select>
            <div id="blockError" class="error">Blok harus dipilih.</div>

            <!-- Field Nomor Rumah -->
            <label for="houseNumber">Nomor Rumah:</label>
            <select id="houseNumber">
                <option value="">Pilih Nomor Rumah</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">13</option>
                <option value="15">15</option>
                <option value="16">16</option>
                <option value="17">17</option>
                <option value="18">18</option>
                <option value="19">19</option>
                <option value="20">20</option>
                <option value="21">21</option>
                <option value="22">22</option>
                <option value="23">23</option>
                <option value="25">25</option>
                <option value="26">26</option>
                <option value="27">27</option>
                <option value="28">28</option>
                <option value="29">29</option>
                <option value="30">30</option>
                <option value="31">31</option>
                <option value="32">32</option>
                <option value="33">33</option>
                <option value="35">35</option>
                <option value="36">36</option>
                <option value="37">37</option>
                <option value="38">38</option>
                <option value="39">39</option>
                <option value="50">50</option>
                <option value="51">51</option>
                <option value="52">52</option>
                <option value="53">53</option>
                <option value="55">55</option>
                <option value="56">56</option>
                <option value="57">57</option>
                <option value="58">58</option>
                <option value="59">59</option>
                <option value="60">60</option>
                <option value="61">61</option>
                <option value="62">62</option>
                <option value="63">63</option>
                <option value="65">65</option>
                <option value="66">66</option>
                <option value="67">67</option>
                <option value="68">68</option>
                <option value="69">69</option>
                <option value="70">70</option>
                <option value="71">71</option>
                <option value="72">72</option>
                <option value="73">73</option>
                <option value="75">75</option>
                <option value="76">76</option>
                <option value="77">77</option>
                <option value="78">78</option>
                <option value="79">79</option>
                <option value="80">80</option>
                <option value="81">81</option>
                <option value="82">82</option>
                <option value="83">83</option>
                <option value="85">85</option>
                <option value="86">86</option>
                <option value="87">87</option>
                <option value="88">88</option>
                <option value="89">89</option>
            </select>
            <div id="houseNumberError" class="error">Nomor rumah harus dipilih.</div>

            <!-- Field Status Pada Rumah -->
            <label for="status">Status Pada Rumah:</label>
            <select id="status" onchange="updateDocumentRequirement()">
                <option value="">Pilih Status</option>
                <option value="Pemilik">Pemilik</option>
                <option value="Pengontrak">Pengontrak</option>
                <option value="Lainnya">Lainnya</option>
            </select>
            <div id="statusError" class="error">Status harus dipilih.</div>
        </div>

        <!-- Halaman 2 -->
        <div class="page" id="page2">
            <h3>Data Pribadi</h3>

            <!-- Field Nama Lengkap -->
            <label for="name">Nama Lengkap:</label>
            <input type="text" id="name" placeholder="Nama Lengkap">
            <div id="nameError" class="error">Nama harus diisi.</div>

            <!-- Field Umur -->
            <label for="age">Umur:</label>
            <input type="number" id="age" placeholder="Umur">
            <div id="ageError" class="error">Umur harus diisi.</div>

            <!-- Field Jenis Kelamin -->
            <label for="gender">Jenis Kelamin:</label>
            <select id="gender">
                <option value="">Pilih Jenis Kelamin</option>
                <option value="Laki-laki">Laki-laki</option>
                <option value="Perempuan">Perempuan</option>
            </select>
            <div id="genderError" class="error">Jenis kelamin harus dipilih.</div>

            <!-- Field Agama -->
            <label for="religion">Agama:</label>
            <select id="religion">
                <option value="">Pilih Agama</option>
                <option value="Islam">Islam</option>
                <option value="Protestan">Protestan</option>
                <option value="Katolik">Katolik</option>
                <option value="Hindu">Hindu</option>
                <option value="Buddha">Buddha</option>
                <option value="Khonghucu">Khonghucu</option>
                <option value="Lainnya">Lainnya</option>
            </select>
            <div id="religionError" class="error">Agama harus dipilih.</div>

            <!-- Field Nomor HP (WhatsApp) -->
            <label for="phone">Nomor HP (WhatsApp):</label>
            <input type="text" id="phone" placeholder="Contoh: 081234567890">
            <div id="phoneError" class="error">Nomor HP harus diisi.</div>

            <!-- Field Pekerjaan/Profesi -->
            <label for="job">Pekerjaan/Profesi:</label>
            <input type="text" id="job" placeholder="Contoh: Karyawan Swasta">
            <div id="jobError" class="error">Pekerjaan harus diisi.</div>

            <!-- Field Nama Perusahaan -->
            <label for="company">Nama Perusahaan:</label>
            <input type="text" id="company" placeholder="Contoh: PT. Contoh Sejahtera">
            <div id="companyError" class="error">Nama perusahaan harus diisi.</div>
        </div>

        <!-- Halaman 3 -->
        <div class="page" id="page3">
            <h3>Data Anggota Keluarga</h3>
            <div class="info">Isi data keluarga selain Anda.</div>

            <!-- Field Jumlah Penghuni Rumah -->
            <label for="familyMembers">Jumlah Penghuni Rumah Selain Anda:</label>
            <input type="number" id="familyMembers" placeholder="Contoh: 3" onchange="generateFamilyFields()">
            <div id="familyMembersError" class="error">Jumlah penghuni harus diisi.</div>

            <!-- Container untuk Field Anggota Keluarga -->
            <div id="familyFieldsContainer"></div>

            <!-- Field Upload Kartu Keluarga / KTP -->
            <label for="document">Upload Kartu Keluarga / KTP:</label>
            <input type="file" id="document" accept="image/*, application/pdf" multiple>
            <div id="documentError" class="error">Dokumen harus diupload.</div>
            <div id="documentInfo" class="info">Wajib mengunggah KTP jika single atau sendiri, dan Kartu Keluarga jika berkeluarga.</div>
        </div>

        <!-- Halaman 4 -->
        <div class="page" id="page4">
            <h3>Verifikasi Tambahan</h3>

            <!-- Field Pertanyaan Jumlah Kendaraan -->
            <label for="vehicleCapacity">Apakah Jumlah Kendaraan sesuai dengan kapasitas Garasi Kendaraan di Rumah?</label>
            <select id="vehicleCapacity" onchange="showVehicleNotification(this.value)">
                <option value="">Pilih Jawaban</option>
                <option value="YA">YA</option>
                <option value="TIDAK">TIDAK</option>
            </select>

            <!-- Field Pertanyaan Hewan Peliharaan -->
            <label for="hasPet">Apakah Anda memiliki hewan peliharaan?</label>
            <select id="hasPet" onchange="showPetNotification(this.value)">
                <option value="">Pilih Jawaban</option>
                <option value="YA">YA</option>
                <option value="TIDAK">TIDAK</option>
            </select>
        </div>

        <!-- Halaman Terima Kasih -->
        <div class="page" id="thankYouPage">
            <h2>Terima Kasih!</h2>
            <p>Proses registrasi Anda telah selesai dan data berhasil dikirimkan.</p>
            <p>Kami akan menghubungi Anda jika diperlukan informasi lebih lanjut.</p>
        </div>
    </div>

    <!-- Container untuk Tombol Navigasi -->
    <div class="button-container">
        <!-- Tombol Kembali (Muncul di Halaman 2, 3, dan 4) -->
        <button class="back-button" id="backButton" onclick="prevPage()" style="display: none;">← Kembali</button>
        
        <!-- Tombol Selanjutnya (Muncul di Halaman 1, 2, dan 3) -->
        <button class="next-button" id="nextButton" onclick="nextPage()">Selanjutnya →</button>
        
        <!-- Tombol Submit (Muncul di Halaman 4) -->
        <button class="submit-button" id="submitButton" onclick="validateAndSubmit()" style="display: none;">Submit</button>
    </div>

    <script>
        let currentPage = 1;
        const totalPages = 4;

        // Fungsi untuk menampilkan halaman aktif
        function showPage(pageNumber) {
            // Sembunyikan semua halaman
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));

            // Tampilkan halaman yang dipilih
            const pageId = pageNumber === 'thankYouPage' ? 'thankYouPage' : `page${pageNumber}`;
            document.getElementById(pageId).classList.add('active');

            // Update tombol navigasi
            document.getElementById('backButton').style.display = pageNumber > 1 ? 'block' : 'none';
            document.getElementById('nextButton').style.display = pageNumber < totalPages ? 'block' : 'none';
            document.getElementById('submitButton').style.display = pageNumber === totalPages ? 'block' : 'none';
        }

        // Fungsi untuk berpindah ke halaman berikutnya
        function nextPage() {
            if (validatePage(currentPage)) {
                currentPage++;
                showPage(currentPage);
            }
        }

        // Fungsi untuk kembali ke halaman sebelumnya
        function prevPage() {
            if (currentPage > 1) {
                currentPage--;
                showPage(currentPage);
            }
        }

        // Fungsi untuk validasi halaman
        function validatePage(pageNumber) {
            const validations = {
                1: ['block', 'houseNumber', 'status'],
                2: ['name', 'age', 'gender', 'religion', 'phone', 'job', 'company'],
                3: ['familyMembers', 'document'],
                4: ['vehicleCapacity', 'hasPet']
            };

            let isValid = true;

            // Validasi untuk halaman 3
            if (pageNumber === 3) {
                const familyMembers = parseInt(document.getElementById('familyMembers').value);
                if (familyMembers > 0) {
                    for (let i = 1; i <= familyMembers; i++) {
                        const fields = [`familyName${i}`, `familyGender${i}`, `familyAge${i}`, `familyReligion${i}`, `familyPosition${i}`];
                        fields.forEach(field => {
                            const element = document.getElementById(field);
                            const errorElement = document.getElementById(`${field}Error`);
                            if (!element.value) {
                                isValid = false;
                                if (errorElement) errorElement.style.display = 'block';
                            } else {
                                if (errorElement) errorElement.style.display = 'none';
                            }
                        });
                    }
                }
            }

            // Validasi untuk halaman lainnya
            validations[pageNumber].forEach(field => {
                const element = document.getElementById(field);
                const errorElement = document.getElementById(`${field}Error`);
                if (!element.value) {
                    isValid = false;
                    if (errorElement) errorElement.style.display = 'block';
                } else {
                    if (errorElement) errorElement.style.display = 'none';
                }
            });

            return isValid;
        }

        // Fungsi untuk menampilkan notifikasi kendaraan
        function showVehicleNotification(value) {
            if (value === "TIDAK") {
                alert("Sesuaikan Jumlah Kendaraan dirumah Anda dengan kapasitas Garasi di Rumah Untuk Ketertiban dan Kenyamanan bersama. Hindari mendzalimi orang lain dengan parkir dijalan karena kapasitas garasi tidak cukup.");
            }
        }

        // Fungsi untuk menampilkan notifikasi hewan peliharaan
        function showPetNotification(value) {
            if (value === "YA") {
                alert("Peraturan awal cluster dari Galuh Mas menyatakan bahwa Penghuni tidak diperkenankan memiliki hewan peliharaan agar tidak mengganggu kenyamanan Warga lain.");
            }
        }

        // Fungsi untuk validasi dan submit data
        function validateAndSubmit() {
            if (validatePage(4)) {
                // Kumpulkan data utama dari form
                const formData = {
                    block: document.getElementById('block').value,
                    houseNumber: document.getElementById('houseNumber').value,
                    status: document.getElementById('status').value,
                    name: document.getElementById('name').value,
                    age: document.getElementById('age').value,
                    gender: document.getElementById('gender').value,
                    religion: document.getElementById('religion').value,
                    phone: document.getElementById('phone').value,
                    job: document.getElementById('job').value,
                    company: document.getElementById('company').value,
                    familyMembers: document.getElementById('familyMembers').value,
                    vehicleCapacity: document.getElementById('vehicleCapacity').value,
                    hasPet: document.getElementById('hasPet').value
                };

                // Kumpulkan data anggota keluarga
                const familyMembers = parseInt(document.getElementById('familyMembers').value);
                if (familyMembers > 0) {
                    formData.familyData = [];
                    for (let i = 1; i <= familyMembers; i++) {
                        formData.familyData.push({
                            name: document.getElementById(`familyName${i}`).value,
                            gender: document.getElementById(`familyGender${i}`).value,
                            age: document.getElementById(`familyAge${i}`).value,
                            religion: document.getElementById(`familyReligion${i}`).value,
                            position: document.getElementById(`familyPosition${i}`).value
                        });
                    }
                }

                // Handle file upload
                const fileInput = document.getElementById('document');
                if (fileInput.files.length > 0) {
                    const file = fileInput.files[0];
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        formData.document = {
                            file: e.target.result.split(',')[1], // Ambil base64
                            filename: file.name,
                            mimeType: file.type
                        };

                        // Kirim data ke Google Apps Script
                        fetch('YOUR_GOOGLE_APPS_SCRIPT_URL', {
                            method: 'POST',
                            body: JSON.stringify(formData),
                            headers: {
                                'Content-Type': 'application/json'
                            }
                        })
                        .then(response => response.text())
                        .then(data => {
                            alert(data); // Tampilkan pesan sukses
                            showPage('thankYouPage'); // Tampilkan halaman terima kasih
                        })
                        .catch(error => {
                            console.error('Error:', error);
                            alert('Terjadi kesalahan saat mengirim data.');
                        });
                    };
                    reader.readAsDataURL(file); // Baca file sebagai base64
                } else {
                    alert("Dokumen harus diupload.");
                }
            }
        }

        // Fungsi untuk menghasilkan field anggota keluarga
        function generateFamilyFields() {
            const familyMembers = parseInt(document.getElementById('familyMembers').value);
            const container = document.getElementById('familyFieldsContainer');
            container.innerHTML = ""; // Kosongkan container terlebih dahulu

            if (familyMembers > 0) {
                for (let i = 1; i <= familyMembers; i++) {
                    const memberDiv = document.createElement('div');
                    memberDiv.classList.add('family-member');
                    memberDiv.innerHTML = `
                        <h4>Anggota Keluarga ${i}</h4>
                        <label for="familyName${i}">Nama:</label>
                        <input type="text" id="familyName${i}" placeholder="Nama Anggota Keluarga">
                        <div id="familyName${i}Error" class="error">Nama harus diisi.</div>

                        <label for="familyGender${i}">Jenis Kelamin:</label>
                        <select id="familyGender${i}">
                            <option value="">Pilih Jenis Kelamin</option>
                            <option value="Laki-laki">Laki-laki</option>
                            <option value="Perempuan">Perempuan</option>
                        </select>
                        <div id="familyGender${i}Error" class="error">Jenis kelamin harus dipilih.</div>

                        <label for="familyAge${i}">Umur:</label>
                        <input type="number" id="familyAge${i}" placeholder="Umur">
                        <div id="familyAge${i}Error" class="error">Umur harus diisi.</div>

                        <label for="familyReligion${i}">Agama:</label>
                        <select id="familyReligion${i}">
                            <option value="">Pilih Agama</option>
                            <option value="Islam">Islam</option>
                            <option value="Protestan">Protestan</option>
                            <option value="Katolik">Katolik</option>
                            <option value="Hindu">Hindu</option>
                            <option value="Buddha">Buddha</option>
                            <option value="Khonghucu">Khonghucu</option>
                            <option value="Lainnya">Lainnya</option>
                        </select>
                        <div id="familyReligion${i}Error" class="error">Agama harus dipilih.</div>

                        <label for="familyPosition${i}">Posisi pada Anggota Keluarga:</label>
                        <select id="familyPosition${i}">
                            <option value="">Pilih Posisi</option>
                            <option value="Suami/Isteri">Suami/Isteri</option>
                            <option value="Anak">Anak</option>
                            <option value="Orang Tua">Orang Tua</option>
                            <option value="Kerabat">Kerabat</option>
                            <option value="Teman">Teman</option>
                            <option value="Assisten Rumah Tangga">Assisten Rumah Tangga</option>
                            <option value="Lainnya">Lainnya</option>
                        </select>
                        <div id="familyPosition${i}Error" class="error">Posisi harus dipilih.</div>
                    `;
                    container.appendChild(memberDiv);
                }
            }
        }

        // Inisialisasi halaman pertama
        showPage(1);
    </script>
</body>
</html>
